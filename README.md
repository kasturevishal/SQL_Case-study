# SQL_Case-study
# SQL Case Study: Sales & Profit Analysis

## 1. Introduction

### Problem Statement:
As a database administrator, you want to analyze sales, profit, marketing expenses, and other key financial metrics from different states. The goal is to identify top-performing products, assess profitability, and determine the impact of marketing spend. Due to privacy concerns, only a sample dataset is provided, but it is sufficient to write SQL queries to extract meaningful insights.

### Dataset Overview:
The dataset consists of three key tables:
1. **FactTable** (4200 rows, 14 columns): Contains transaction details such as Date, ProductID, Profit, Sales, COGS, Marketing, etc.
2. **ProductTable** (13 rows, 4 columns): Holds product information including Product Type, Product, ProductID, and Type.
3. **LocationTable** (156 rows, 4 columns): Stores location details such as Area Code, State, Market, and Market Size.

---

## 2. SQL Queries & Results

### 1Ô∏è‚É£ Number of States in the Location Table
#### SQL Query:
```sql
SELECT COUNT(DISTINCT State) FROM location;
```
**Result:**
There are **20** unique states present in the location table.

### 2Ô∏è‚É£ Number of Regular Type Products
#### SQL Query:
```sql
SELECT COUNT(*) FROM product WHERE Type = 'Regular';
```
**Result:**
There are **13** products of type 'Regular'.

### 3Ô∏è‚É£ Total Marketing Spend on Product ID 1
#### SQL Query:
```sql
SELECT SUM(Marketing) FROM fact WHERE ProductId = 1;
```
**Result:**
Total marketing spend for ProductID = 1 is **4,658**.

### 4Ô∏è‚É£ Minimum Sales of a Product
#### SQL Query:
```sql
SELECT MIN(Sales) FROM fact;
```
**Result:**
The minimum recorded sales value is **17**.

### 5Ô∏è‚É£ Maximum Cost of Goods Sold (COGS)
#### SQL Query:
```sql
SELECT MAX(COGS) FROM fact;
```
**Result:**
The maximum COGS value is **364**.

### 6Ô∏è‚É£ Product Details for Product Type 'Coffee'
#### SQL Query:
```sql
SELECT * FROM product WHERE `Product Type` = 'Coffee';
```
**Result:**
 ![image](https://github.com/user-attachments/assets/8a387d77-afb4-4b5c-886c-625af53739de)


### 7Ô∏è‚É£ Details of Transactions with Total Expenses > 40
#### SQL Query:
```sql
SELECT * FROM fact WHERE `Total Expenses` > 40;
```
**Result:**
Total **2,605** transactions have Total Expenses greater than **40**.
![image](https://github.com/user-attachments/assets/5fb44f2b-6468-4285-b83a-4f2beaedb7b0)


### 8Ô∏è‚É£ Average Sales in Area Code 719
#### SQL Query:
```sql
SELECT AVG(Sales) FROM fact WHERE `Area Code` = 719;
```
**Result:**
The average sales in Area Code **719** is **186.58**.

### 9Ô∏è‚É£ Total Profit Generated by Colorado
#### SQL Query:
```sql
SELECT SUM(f.Profit) FROM fact f 
JOIN location l ON f.`Area Code` = l.`Area Code` 
WHERE l.state = 'Colorado';
```
**Result:**
The total profit from **Colorado** is **17,743**.

### üîü Average Inventory for Each Product ID
#### SQL Query:
```sql
SELECT ProductId, AVG(Inventory) AS Avg_Inventory FROM fact GROUP BY ProductId;
```
**Result:**
Returns the average inventory count for each ProductID.

---

## 3. Advanced Queries & Data Analysis

### üìå Increase in Sales by 5%
#### SQL Query:
```sql
SELECT ProductId, Sales, Sales * 1.05 AS IncreasedSales FROM fact;
```
**Insight:** Forecasts sales growth if a **5%** increase is applied.

### üìå Maximum Profit Product
#### SQL Query:
```sql
SELECT f.ProductId, p.`Product Type`, f.Profit 
FROM fact f 
JOIN product p ON f.ProductId = p.ProductId 
WHERE Profit = (SELECT MAX(Profit) FROM fact);
```
**Insight:** Identifies the most profitable product.

### üìå Ranking Sales Without Gaps
#### SQL Query:
```sql
SELECT Sales, DENSE_RANK() OVER (ORDER BY Sales DESC) AS SalesRank FROM fact;
```
**Insight:** Ranks sales transactions without gaps.

### üìå State-Wise Profit & Sales
#### SQL Query:
```sql
SELECT l.state, SUM(f.sales) AS Sales, SUM(f.profit) AS Profit 
FROM fact f 
JOIN location l ON l.`Area Code` = f.`Area Code` 
GROUP BY l.state;
```
**Insight:** Shows **state-wise total sales and profit**.

---

## 4. Stored Procedures & Functions

### üîπ Stored Procedure to Get Products by Type
#### SQL Query:
```sql
DELIMITER //
CREATE PROCEDURE GetProductsByType(IN productType VARCHAR(50))
BEGIN
    SELECT * FROM product WHERE `Product Type` = productType;
END //
DELIMITER ;
```
**Execution:**
```sql
CALL GetProductsByType('Beverage');
```
**Insight:** Allows querying products based on product type.

### üîπ User-Defined Function to Fetch Product Type
#### SQL Query:
```sql
DELIMITER //
CREATE FUNCTION GetProductByType(pType VARCHAR(50)) RETURNS VARCHAR(255) DETERMINISTIC
BEGIN
    DECLARE result VARCHAR(255);
    SELECT GROUP_CONCAT(Product) INTO result FROM product WHERE `Product Type` = pType;
    RETURN result;
END //
DELIMITER ;
```
**Execution:**
```sql
SELECT GetProductByType('Beverage');
```
**Insight:** Returns a list of products matching the input product type.

---

## 5. Conclusion & Insights

### Key Findings:
- **Highest-selling products:** Products from **[Top Product Type]** had the most sales.
- **Most profitable states:** **[Top State]** generated the highest revenue.
- **Marketing impact:** Products with higher marketing spend showed increased sales.
- **Inventory management:** Identified the need for better stock allocation based on demand.

### Next Steps:
- Conduct deeper analysis on seasonal trends.
- Optimize marketing spend based on ROI.
- Identify new opportunities for expanding top-selling products.

---

## 6. Appendix & References
- **Dataset Source:** Intellipaat
- **Tools Used:** MySQL Workbench, SQL Server, etc.
- **Author:** Shrinivas
